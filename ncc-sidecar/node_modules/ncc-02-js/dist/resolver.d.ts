/**
 * Custom error class for NCC-02 specific failures.
 */
export class NCC02Error extends Error {
    /**
     * @param {string} code
     * @param {string} message
     * @param {any} [cause]
     */
    constructor(code: string, message: string, cause?: any);
    code: string;
    cause: any;
}
/**
 * @typedef {Object} ResolvedService
 * @property {string|undefined} endpoint
 * @property {string|undefined} fingerprint
 * @property {number} expiry
 * @property {any[]} attestations
 * @property {string} eventId
 * @property {string} pubkey
 */
/**
 * Resolver for NCC-02 Service Records.
 * Implements the client-side resolution and trust verification algorithm.
 */
export class NCC02Resolver {
    /**
     * @param {string[]} relays - List of relay URLs.
     * @param {Object} [options={}]
     * @param {SimplePool} [options.pool] - Shared SimplePool instance.
     * @param {string[]} [options.trustedCAPubkeys=[]] - List of trusted CA pubkeys (hex or npub).
     * These are the ONLY pubkeys whose attestation signatures (Kind 30060) will be accepted
     * by the resolver. This allows you to define your own web of trust or rely on specific
     * community auditors. If empty, all attestations are ignored (effectively disabling attestation checks).
     */
    constructor(relays: string[], options?: {
        pool?: SimplePool;
        trustedCAPubkeys?: string[];
    });
    relays: string[];
    pool: SimplePool;
    ownsPool: boolean;
    trustedCAPubkeys: Set<string>;
    /**
     * Closes the connection to the relays if the pool is owned by this resolver.
     */
    close(): void;
    /**
     * Internal query helper using SimplePool.subscribeMany (since list() is deprecated).
     * @param {import('nostr-tools').Filter} filter
     * @returns {Promise<import('nostr-tools').Event[]>}
     */
    _query(filter: import("nostr-tools").Filter): Promise<import("nostr-tools").Event[]>;
    /**
     * Resolves a service for a given pubkey and service identifier.
     *
     * @param {string} pubkey - The pubkey of the service owner.
     * @param {string} serviceId - The 'd' tag identifier of the service (e.g., 'api').
     * @param {Object} [options={}] - Policy options.
     * @param {boolean} [options.requireAttestation=false] - If true, fails if no trusted attestation is found.
     * @param {string} [options.minLevel=null] - Minimum trust level ('self', 'verified', 'hardened').
     * @param {string} [options.standard='nostr-service-trust-v0.1'] - Expected trust standard.
     * @throws {NCC02Error} If verification or policy checks fail.
     * @returns {Promise<ResolvedService>} The verified service details.
     */
    resolve(pubkey: string, serviceId: string, options?: {
        requireAttestation?: boolean;
        minLevel?: string;
        standard?: string;
    }): Promise<ResolvedService>;
    /**
     * @param {string | undefined} actual
     * @param {string} required
     */
    _isLevelSufficient(actual: string | undefined, required: string): boolean;
    /**
     * @param {any} att
     * @param {any} tags
     * @param {any[]} revocations
     */
    _isAttestationValid(att: any, tags: any, revocations: any[]): boolean;
    /**
     * Verifies that the actual fingerprint found during transport-level connection
     * matches the one declared in the signed service record.
     *
     * @param {ResolvedService} resolved - The object returned by resolve().
     * @param {string} actualFingerprint - The fingerprint obtained from the service.
     * @returns {boolean}
     */
    verifyEndpoint(resolved: ResolvedService, actualFingerprint: string): boolean;
}
export type ResolvedService = {
    endpoint: string | undefined;
    fingerprint: string | undefined;
    expiry: number;
    attestations: any[];
    eventId: string;
    pubkey: string;
};
import { SimplePool } from 'nostr-tools';
